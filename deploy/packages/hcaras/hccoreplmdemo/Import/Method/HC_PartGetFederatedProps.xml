<AML>
 <Item type="Method" id="162FDE8BCA75406B8FD9EFB97AAABFCA" action="add">
  <execution_allowed_to keyed_name="World" type="Identity">A73B655731924CD0B027E4F4D5FCC0A9</execution_allowed_to>
  <method_code><![CDATA[
Innovator inn = this.getInnovator();
for (int i=0; i<this.getItemCount(); i++) {
    Item thisItem = this.getItemByIndex(i);
    string configId = thisItem.getProperty("config_id", "N/A");
    bool isCurrentAndReleased = false;
    
    if (thisItem.getProperty("is_current") == "1" && thisItem.getProperty("state") == "Released") {
        isCurrentAndReleased = true;
    }

    if (isCurrentAndReleased) {
        // Query for (Express) ECO
        string amlQuery = @"<AML>
            <Item type='Express ECO' action='get' select='change_reason'>
                <Relationships>
                <Item action='get' type='Express ECO Affected Item' select='related_id'>
                <related_id>
                <Item type='Affected Item' select='new_item_id'>
                <new_item_id>{0}</new_item_id>
                </Item>
                </related_id>
                </Item>
                </Relationships>
            </Item>
            </AML>";
        amlQuery = String.Format(amlQuery,thisItem.getID());
        Item ecoResult = inn.applyAML(amlQuery);
        if (!ecoResult.isError() && ecoResult.getItemCount() == 1) {
            string changeReason = ecoResult.getProperty("change_reason");
            thisItem.setProperty("hc_latest_change_note", changeReason);
        }
    }
}

return this;
]]></method_code>
  <method_type>C#</method_type>
  <name>HC_PartGetFederatedProps</name>
 </Item>
</AML>